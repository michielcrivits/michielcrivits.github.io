<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:v="urn:schemas-microsoft-com:vml">
	<head>
		<meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
		<title>Google Maps GPX Test - async</title>
		<style type="text/css">
			v\:* {
				behavior:url(#default#VML);
			}
		</style>

		<!-- Make the document body take up the full screen -->
		<style type="text/css">
			html, body {width: 100%; height: 100%}
			body {margin-top: 0px; margin-right: 0px; margin-left: 0px; margin-bottom: 0px}
		</style>

        <!-- Replace the key in the line below with an API key for your site.  You can get one here http://www.google.com/apis/maps/signup.html -->
		
        <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
		<script src="loadgpx.js" type="text/javascript"></script>
		
	</head>
	<body >
		<div id="map" style="width: 100%; height: 100%;"></div>

        <script type="text/javascript">

            //<![CDATA[
    
            var MyMap;
    
            function LoadGPXFileIntoGoogleMap(map, filename)
            {
                var request = new XMLHttpRequest();
                request.open("GET", filename, true);
                request.onreadystatechange = function()
                {
                    if (request.readyState == 4)
                    {
                        parser = new GPXParser(request.responseXML, map);
                        parser.setTrackColour("#ff0000");					// Set the track line colour
                        parser.setTrackWidth(3);							// Set the track line width
                        parser.setMinTrackPointDelta(0.001);				// Set the minimum distance between track points
                        parser.centerAndZoom(request.responseXML);			// Center and Zoom the map over all the points.
                        parser.addTrackpointsToMap();						// Add the trackpoints
                        parser.addWaypointsToMap();							// Add the waypoints
                    }
                }
                request.send(null);
            }
    
            function initialiseMap()
            {
                MyMap = new google.maps.Map(document.getElementById("map"), {
                      center: {lat: 43.373058	, lng: -1.773991},
                      zoom: 8
                });
    
                LoadGPXFileIntoGoogleMap(MyMap, "HRP.gpx.xml");
            }
    
            //]]>
    
            
            </script>
            <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCevCgtTXxREUE-dilAREbSL6_6TmCSpAQ&callback=initialiseMap" type="text/javascript"></script>
	</body>
</html>
